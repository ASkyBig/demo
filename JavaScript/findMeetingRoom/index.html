<!DOCTYPE html>
<html>
   <head>
      <style>
         .hideP {
            display: none;
         }
      </style>
   </head>
   
   <body>
      <p id="des">作为一个没有方向感的人，经常开会找不到会议室，所以就做了这个，灰常简陋，说不定还有bug~</p>
      <input placeholder="请输入你要找的会议室" id="name">
      <button onClick="findRoom()">确定</button>
      <div>
         <canvas id="canvas" width="2000px" height="1000px"></canvas>
      </div>
      <div style="width: 0; height: 0;">
          <img src="https://askybig.github.io/demo/JavaScript/findMeetingRoom/0F.jpg">
          <img src="https://askybig.github.io/demo/JavaScript/findMeetingRoom/1F.jpg">
          <img src="https://askybig.github.io/demo/JavaScript/findMeetingRoom/2F.jpg">
          <img src="https://askybig.github.io/demo/JavaScript/findMeetingRoom/3F.jpg">
          <img src="https://askybig.github.io/demo/JavaScript/findMeetingRoom/4F.jpg">
          <img src="https://askybig.github.io/demo/JavaScript/findMeetingRoom/5F.jpg">
      </div>
     <script>
     // 如果存在
     if(localStorage.getItem('ywMeeting')) {
         document.getElementById("des").classList.add("hideP")
     } else {
         localStorage.setItem('ywMeeting','1')
     }
      const allRoomNames = {
                            "1F":["幻灵", "仙游", "修真", "武道", "影音室", "活动区", "瑜伽室"],
                            "2F": ["元神", "金丹", "万载", "炼气", "出窍", "筑基"],
                            "3F": ["镇元", "太白", "黎山", "千秋", "祝融", "梵天", "颛顼"],
                            "4F": ["白虎", "凤凰", "青龙玄武", "麒麟", "鲲鹏"],
                            "5F": ["天璇", "天玑", "天权", "雷霆", "紫薇"]
                           }
      const allRoomPos = {
                           "幻灵": {'p1': {'x': 1005, 'y': 635}, 'p2': {'x': 1005, 'y': 690}, 'p3': {'x': 935, 'y': 690}, 'p4': {'x': 935, 'y': 635}},
                           "仙游": {'p1': {'x': 1005, 'y': 535}, 'p2': {'x': 1005, 'y': 580}, 'p3': {'x': 935, 'y': 580}, 'p4': {'x': 935, 'y': 535}},
                           "修真": {'p1': {'x': 1005, 'y': 365}, 'p2': {'x': 1005, 'y': 410}, 'p3': {'x': 935, 'y': 410}, 'p4': {'x': 935, 'y': 365}},
                           "武道": {'p1': {'x': 1005, 'y': 322}, 'p2': {'x': 1005, 'y': 365}, 'p3': {'x': 935, 'y': 365}, 'p4': {'x': 935, 'y': 315}},
                           "影音室": {'p1': {'x': 500, 'y': 250}, 'p2': {'x': 500, 'y': 320}, 'p3': {'x': 300, 'y': 320}, 'p4': {'x': 300, 'y': 250}},
                           "活动区": {'p1': {'x': 440, 'y': 325}, 'p2': {'x': 440, 'y': 375}, 'p3': {'x': 380, 'y': 375}, 'p4': {'x': 380, 'y': 325}},
                           "瑜伽室": {'p1': {'x': 1140, 'y': 535}, 'p2': {'x': 1140, 'y': 600}, 'p3': {'x': 1020, 'y': 600}, 'p4': {'x': 1020, 'y': 535}},

                           "元神": {'p1': {'x': 1030, 'y': 395}, 'p2': {'x': 1030, 'y': 470}, 'p3': {'x': 955, 'y': 470}, 'p4': {'x': 955, 'y': 395}},
                           "金丹": {'p1': {'x': 1030, 'y': 300}, 'p2': {'x': 1030, 'y': 370}, 'p3': {'x': 955, 'y': 370}, 'p4': {'x': 955, 'y': 300}},
                           "万载": {'p1': {'x': 850, 'y': 270}, 'p2': {'x': 850, 'y': 370}, 'p3': {'x': 700, 'y': 370}, 'p4': {'x': 700, 'y': 270}}, 
                           "炼气": {'p1': {'x': 410, 'y': 270}, 'p2': {'x': 410, 'y': 310}, 'p3': {'x': 340, 'y': 310}, 'p4': {'x': 340, 'y': 270}},
                           "出窍": {'p1': {'x': 300, 'y': 270}, 'p2': {'x': 300, 'y': 310}, 'p3': {'x': 220, 'y': 310}, 'p4': {'x': 220, 'y': 270}},
                           "筑基": {'p1': {'x': 140, 'y': 280}, 'p2': {'x': 140, 'y': 320}, 'p3': {'x': 80, 'y': 320}, 'p4': {'x': 80, 'y': 280}},

                           "镇元": {'p1': {'x': 1010, 'y': 535}, 'p2': {'x': 1010, 'y': 585}, 'p3': {'x': 945, 'y': 585}, 'p4': {'x': 945, 'y': 535}},
                           "太白": {'p1': {'x': 1010, 'y': 365}, 'p2': {'x': 1010, 'y': 410}, 'p3': {'x': 945, 'y': 410}, 'p4': {'x': 945, 'y': 365}},
                           "黎山": {'p1': {'x': 1010, 'y': 315}, 'p2': {'x': 1010, 'y': 365}, 'p3': {'x': 945, 'y': 365}, 'p4': {'x': 945, 'y': 310}},
                           "千秋": {'p1': {'x': 840, 'y': 270}, 'p2': {'x': 840, 'y': 370}, 'p3': {'x': 700, 'y': 370}, 'p4': {'x': 700, 'y': 270}}, 
                           "祝融": {'p1': {'x': 550, 'y': 270}, 'p2': {'x': 550, 'y': 305}, 'p3': {'x': 455, 'y': 305}, 'p4': {'x': 455, 'y': 270}}, 
                           "梵天": {'p1': {'x': 400, 'y': 270}, 'p2': {'x': 400, 'y': 305}, 'p3': {'x': 345, 'y': 305}, 'p4': {'x': 345, 'y': 270}}, 
                           "颛顼": {'p1': {'x': 300, 'y': 270}, 'p2': {'x': 300, 'y': 305}, 'p3': {'x': 225, 'y': 305}, 'p4': {'x': 225, 'y': 270}},

                           "白虎": {'p1': {'x': 1005, 'y': 735}, 'p2': {'x': 1005, 'y': 770}, 'p3': {'x': 920, 'y': 770}, 'p4': {'x': 920, 'y': 735}}, 
                           "凤凰": {'p1': {'x': 1005, 'y': 570}, 'p2': {'x': 1005, 'y': 610}, 'p3': {'x': 920, 'y': 610}, 'p4': {'x': 920, 'y': 570}}, 
                           "青龙玄武": {'p1': {'x': 840, 'y': 175}, 'p2': {'x': 840, 'y': 250}, 'p3': {'x': 720, 'y': 250}, 'p4': {'x': 720, 'y': 175}}, 
                           "麒麟": {'p1': {'x': 560, 'y': 265}, 'p2': {'x': 560, 'y': 305}, 'p3': {'x': 465, 'y': 305}, 'p4': {'x': 465, 'y': 265}},
                           "鲲鹏": {'p1': {'x': 310, 'y': 265}, 'p2': {'x': 310, 'y': 305}, 'p3': {'x': 225, 'y': 305}, 'p4': {'x': 225, 'y': 265}},

                           "天璇": {'p1': {'x': 1035, 'y': 625}, 'p2': {'x': 1035, 'y': 680}, 'p3': {'x': 970, 'y': 680}, 'p4': {'x': 970, 'y': 625}}, 
                           "天玑": {'p1': {'x': 1035, 'y': 560}, 'p2': {'x': 1035, 'y': 600}, 'p3': {'x': 970, 'y': 600}, 'p4': {'x': 970, 'y': 560}}, 
                           "天权": {'p1': {'x': 1035, 'y': 525}, 'p2': {'x': 1035, 'y': 560}, 'p3': {'x': 970, 'y': 560}, 'p4': {'x': 970, 'y': 525}}, 

                           "雷霆": {'p1': {'x': 1035, 'y': 370}, 'p2': {'x': 1035, 'y': 440}, 'p3': {'x': 970, 'y': 440}, 'p4': {'x': 970, 'y': 370}}, 
                           "紫薇": {'p1': {'x': 1035, 'y': 300}, 'p2': {'x': 1035, 'y': 360}, 'p3': {'x': 970, 'y': 360}, 'p4': {'x': 970, 'y': 300}}, 
                         }
   
      function findRoom () {
         let name = document.getElementById("name").value;
         let whickF = 0;
         const fArr = Object.keys(allRoomNames);
         for( let i = 0; i < fArr.length; i++) {
            if( whickF != 0) break
            let f = i + 1;
            for(let j = 0; j < allRoomNames[fArr[i]].length; j++) {
               if( name === allRoomNames[fArr[i]][j]) {
                  whickF = f;
                  break;
               }
            }
         }
         drawImageAndLines(name, whickF)
      }

      function getPixelRatio (context) {
        var backingStore = context.backingStorePixelRatio ||
            context.webkitBackingStorePixelRatio ||
            context.mozBackingStorePixelRatio ||
            context.msBackingStorePixelRatio ||
            context.oBackingStorePixelRatio ||
            context.backingStorePixelRatio || 1;
         return (window.devicePixelRatio || 1) / backingStore;
      }

      function drawImageAndLines (name, whickF) {
         var ctx = document.getElementById('canvas').getContext('2d');
         var ratio = getPixelRatio(ctx);
       
         var img = new Image();
         img.src = `./${whickF}F.jpg`;
         img.onload = function() {
              ctx.drawImage(img, 0, 0, ratio * 600, ratio * 400);
              ctx.beginPath();
              ctx.strokeStyle="red";
              let pos = allRoomPos[name]
              ctx.moveTo(pos.p1.x + 10, pos.p1.y - 10);
              ctx.lineTo(pos.p2.x + 10, pos.p2.y + 10);
              ctx.lineTo(pos.p3.x - 10, pos.p3.y + 10);
              ctx.lineTo(pos.p4.x - 10, pos.p4.y - 10);
              ctx.closePath()
              ctx.stroke();
         }
      }

      var comment = document.createComment( '找下会议室!' );
      document.body.appendChild( comment );
     </script>
   </body>
</html>
